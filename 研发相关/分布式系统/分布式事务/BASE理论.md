# BASE理论

`BASE` 理论指的是基本可用 `Basically Available` ，软状态 `Soft State` ，最终一致性 `Eventual Consistency` ，核心思想是即便无法做到强一致性，但应该采用适合的方式保证最终一致性。

`BASE` 理论本质上是对 `CAP` 理论的延伸，是对 `CAP` 中 `AP` 方案的一个补充。

## Basically Available 基本可用

分布式系统在出现故障的时候，允许损失部分可用性，即保证核心可用。

- 响应时间上的损失

    正常情况下，一个在线搜索引擎需要0.5秒内返回给用户相应的查询结果，但由于出现异常（比如系统部分机房发生断电或断网故障），查询结果的响应时间增加到了1~2秒。

- 功能上的损失

    正常情况下，在一个电子商务网站上进行购物，消费者几乎能够顺利地完成每一笔订单，但是在一些节日大促购物高峰的时候，由于消费者的购物行为激增，为了保护购物系统的稳定性，部分消费者可能会被引导到一个降级页面。

## Soft State 软状态

允许系统存在中间状态，而该中间状态不会影响系统整体可用性。

## Eventual Consistency 最终一致性

系统中的所有数据副本经过一定时间后，最终能够达到一致的状态。

在实际工程实践中，最终一致性存在以下五类主要变种。

- 因果一致性

    如果进程A在更新完某个数据项后通知了进程B，那么进程B之后对该数据项的访问都应该能够获取到进程A更新后的最新值，并且如果进程B要对该数据项进行更新操作的话，务必基于进程A更新后的最新值，即不能发生丢失更新情况。与此同时，与进程A无因果关系的进程C的数据访问则没有这样的限制。

- 读己之所写

    进程A更新一个数据项之后，它自己总是能够访问到更新过的最新值，而不会看到旧值。也就是说，对于单个数据获取者而言，其读取到的数据一定不会比自己上次写入的值旧。因此，读己之所写也可以看作是一种特殊的因果一致性。

- 会话一致性

    将对系统数据的访问过程框定在一个会话当中：系统能保证在同一个有效的会话中实现“读己之所写”的一致性，也就是说，执行更新操作之后，客户端能够在同一个会话中始终读取到该数据项的最新值。

- 单调读一致性

    如果一个进程从系统中读取出一个数据项的某个值后，那么系统对于该进程后续的任何数据访问都不应该返回更旧的值。

- 单调写一致性

    一个系统需要能够保证来自同一个进程的写操作被顺序地执行。

## 参考

- [分布式系统的BASE理论](https://www.hollischuang.com/archives/672)

- [CAP原则(CAP定理)、BASE理论](https://www.cnblogs.com/duanxz/p/5229352.html)

- [分布式理论(二) - BASE理论](https://juejin.cn/post/6844903621495095304)

